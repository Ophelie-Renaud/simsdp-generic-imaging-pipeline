/**
 * @file Core0.c
 * @generated by CPrinter
 * @date Wed May 21 12:28:11 CEST 2025
 *
 * Code generated for processing element Core0 (ID=0).
 */

#include "preesm_gen.h"
// Core Global Declaration
extern pthread_barrier_t iter_barrier;
extern int preesmStopThreads;

#ifdef PREESM_MD5_UPDATE
extern struct rk_sema preesmPrintSema;
#endif

// Core Global Definitions

void* computationThread_delta(void *arg) {
  ThreadArgs* args = (ThreadArgs*) arg;  // Conversion du pointeur void* en ThreadArgs*
  int num_vis = args->num_vis;
  int grid_size = args->grid_size;
  int num_minor_cycle = args->num_minor_cycle;
  const char* ms_path = args->ms_path;
  const char* out_path = args->out_path;
  int num_baselines = 130816;
  int num_receiver = 512;
  int slice = 4;
  int num_kernels = 17;
  int total_kernels_samples = 108800;

  char *const FIFO_Head_delta_end_out_Broadcast_gridded_measured_prev__d__0 = (char*) malloc(grid_size*grid_size * sizeof(char));

PRECISION2 *const output_grid__input_grid__0 = (PRECISION2*) malloc(grid_size*grid_size*slice * sizeof(PRECISION2));
PRECISION2 *const output_grid__grids__0 = (PRECISION2*) malloc(grid_size*grid_size*slice * sizeof(PRECISION2));
PRECISION2 *const merge__grids__0 = (PRECISION2*) malloc(grid_size*grid_size*slice * sizeof(PRECISION2));
PRECISION2 *const prev_grid__prev_grid__0 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION *const fft_run_0__dirty_image_in__0 = (PRECISION*) malloc(grid_size*grid_size * sizeof(PRECISION));
PRECISION *const dirty_image_out__image__0 = (PRECISION*) malloc(grid_size*grid_size * sizeof(PRECISION));
PRECISION2 *const fourier__uv_grid_in__0 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const uv_grid_out__uv_grid_in__0 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const uv_grid_out__input_grid__0 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const output_grid_0__input_grid__0 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const output_grid_1__input_grid__0 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const output_grid_2__input_grid__0 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const output_grid_3__input_grid__0 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const output_grid__input__0 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const output_grid__grids_0__0 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const output_grid__grids_1__0 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const output_grid__grids_2__0 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const output_grid__grids_3__0 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const prev_1__prev_grid__0 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const merge_0__grids_0__0 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const output_grid__input__1 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const output_grid__uv_grid_in__0 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const prev_1__prev_grid__1 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const merge_0__grids_1__0 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const uv_grid_out__uv_grid_in__1 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const output_grid__input__2 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const uv_grid_out__uv_grid__0 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const prev_1__prev_grid__2 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const merge_0__grids_2__0 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION *const dirty_image__dirty_image_in__0 = (PRECISION*) malloc(grid_size*grid_size * sizeof(PRECISION));
PRECISION2 *const output_grid__input__3 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION *const dirty_image_out__estimate__0 = (PRECISION*) malloc(grid_size*grid_size * sizeof(PRECISION));
PRECISION2 *const merge_0__grids_3__0 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const prev_1_1__prev_1__0 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const output_grid__uv_grid_in__1 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const uv_grid_out__uv_grid_in__2 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION2 *const uv_grid_out__uv_grid__1 = (PRECISION2*) malloc(grid_size*grid_size * sizeof(PRECISION2));
PRECISION *const dirty_image__dirty_image_in__1 = (PRECISION*) malloc(grid_size*grid_size * sizeof(PRECISION));
PRECISION *const dirty_image_out__measurements__0 = (PRECISION*) malloc(grid_size*grid_size * sizeof(PRECISION));
PRECISION2 *const output_visibilities__measured_visibilities__0 = (PRECISION2*) malloc(num_vis * sizeof(PRECISION2));
PRECISION3 *const output_finegrid_vis_coords__vis_coords__0 = (PRECISION3*) malloc(num_vis * sizeof(PRECISION3));
int *const num_output_visibilities__num_corrected_vis__0 = (int*) malloc(1 * sizeof(int));
PRECISION2 *const visibilities_out__input_visibilities__0 = (PRECISION2*) malloc(num_vis * sizeof(PRECISION2));
PRECISION3 *const out_vis_coords__input__0 = (PRECISION3*) malloc(num_vis * sizeof(PRECISION3));
PRECISION3 *const out_vis_coords_0__input__0 = (PRECISION3*) malloc((size_t) ceil((double)num_vis / slice) * sizeof(PRECISION3));
PRECISION3 *const out_vis_coords_1__input__0 = (PRECISION3*) malloc((size_t) ceil((double)num_vis / slice) * sizeof(PRECISION3));
PRECISION3 *const out_vis_coords_2__input__0 = (PRECISION3*) malloc((size_t) ceil((double)num_vis / slice) * sizeof(PRECISION3));
PRECISION3 *const out_vis_coords_3__input__0 = (PRECISION3*) malloc((size_t) ceil((double)num_vis / slice) * sizeof(PRECISION3));
PRECISION3 *const g2g_0__corrected_vis_uvw_coords__0 = (PRECISION3*) malloc((size_t) ceil((double)num_vis / slice) * sizeof(PRECISION3));
PRECISION3 *const grid_measured_1__corrected_vis_uvw_coords__0 = (PRECISION3*) malloc((size_t) ceil((double)num_vis / slice) * sizeof(PRECISION3));
PRECISION3 *const g2g_0__corrected_vis_uvw_coords__1 = (PRECISION3*) malloc((size_t) ceil((double)num_vis / slice) * sizeof(PRECISION3));
PRECISION3 *const grid_measured_1__corrected_vis_uvw_coords__1 = (PRECISION3*) malloc((size_t) ceil((double)num_vis / slice) * sizeof(PRECISION3));
PRECISION3 *const g2g_0__corrected_vis_uvw_coords__2 = (PRECISION3*) malloc((size_t) ceil((double)num_vis / slice) * sizeof(PRECISION3));
PRECISION3 *const grid_measured_1__corrected_vis_uvw_coords__2 = (PRECISION3*) malloc((size_t) ceil((double)num_vis / slice) * sizeof(PRECISION3));
PRECISION3 *const g2g_0__corrected_vis_uvw_coords__3 = (PRECISION3*) malloc((size_t) ceil((double)num_vis / slice) * sizeof(PRECISION3));
PRECISION3 *const grid_measured_1__corrected_vis_uvw_coords__3 = (PRECISION3*) malloc((size_t) ceil((double)num_vis / slice) * sizeof(PRECISION3));
PRECISION2 *const gridding_kernels_0_3__input__0 = (PRECISION2*) malloc(total_kernels_samples * sizeof(PRECISION2));
PRECISION2 *const gridding_kernels_1_3__input__0 = (PRECISION2*) malloc(total_kernels_samples * sizeof(PRECISION2));
PRECISION2 *const gridding_kernels_2_3__input__0 = (PRECISION2*) malloc(total_kernels_samples * sizeof(PRECISION2));
PRECISION2 *const gridding_kernels_3_3__input__0 = (PRECISION2*) malloc(total_kernels_samples * sizeof(PRECISION2));
PRECISION2 *const degridding_kernels_0_3__degridding_kernels__0 = (PRECISION2*) malloc(total_kernels_samples * sizeof(PRECISION2));
PRECISION2 *const degridding_kernels_1_3__degridding_kernels__0 = (PRECISION2*) malloc(total_kernels_samples * sizeof(PRECISION2));
PRECISION2 *const degridding_kernels_2_3__degridding_kernels__0 = (PRECISION2*) malloc(total_kernels_samples * sizeof(PRECISION2));
PRECISION2 *const degridding_kernels_3_3__degridding_kernels__0 = (PRECISION2*) malloc(total_kernels_samples * sizeof(PRECISION2));
PRECISION2 *const g2g_1__gridding_kernels__0 = (PRECISION2*) malloc(total_kernels_samples * sizeof(PRECISION2));
PRECISION2 *const grid_measured_0__kernels__0 = (PRECISION2*) malloc(total_kernels_samples * sizeof(PRECISION2));
PRECISION2 *const g2g_1__gridding_kernels__1 = (PRECISION2*) malloc(total_kernels_samples * sizeof(PRECISION2));
PRECISION2 *const grid_measured_0__kernels__1 = (PRECISION2*) malloc(total_kernels_samples * sizeof(PRECISION2));
PRECISION2 *const g2g_1__gridding_kernels__2 = (PRECISION2*) malloc(total_kernels_samples * sizeof(PRECISION2));
PRECISION2 *const grid_measured_0__kernels__2 = (PRECISION2*) malloc(total_kernels_samples * sizeof(PRECISION2));
PRECISION2 *const g2g_1__gridding_kernels__3 = (PRECISION2*) malloc(total_kernels_samples * sizeof(PRECISION2));
PRECISION2 *const grid_measured_0__kernels__3 = (PRECISION2*) malloc(total_kernels_samples * sizeof(PRECISION2));
PRECISION *const inv_conv_correction_0__prolate__0 = (PRECISION*) malloc((size_t) ceil((double)grid_size / 2) * sizeof(PRECISION));
PRECISION *const conv_correction_1__prolate__0 = (PRECISION*) malloc((size_t) ceil((double)grid_size / 2) * sizeof(PRECISION));
PRECISION *const conv_correction_est_2__prolate__0 = (PRECISION*) malloc((size_t) ceil((double)grid_size / 2) * sizeof(PRECISION));
PRECISION2 *const gains_out__gains__0 = (PRECISION2*) malloc(num_receiver * sizeof(PRECISION2));
int2 *const gridding_kernel_supports_0_3__input__0 = (int2*) malloc(num_kernels * sizeof(int2));
int2 *const gridding_kernel_supports_1_3__input__0 = (int2*) malloc(num_kernels * sizeof(int2));
int2 *const gridding_kernel_supports_2_3__input__0 = (int2*) malloc(num_kernels * sizeof(int2));
int2 *const gridding_kernel_supports_3_3__input__0 = (int2*) malloc(num_kernels * sizeof(int2));
int2 *const degridding_kernel_supports_0_3__degridding_kernel_supports__0 = (int2*) malloc(num_kernels * sizeof(int2));
int2 *const degridding_kernel_supports_1_3__degridding_kernel_supports__0 = (int2*) malloc(num_kernels * sizeof(int2));
int2 *const degridding_kernel_supports_2_3__degridding_kernel_supports__0 = (int2*) malloc(num_kernels * sizeof(int2));
int2 *const degridding_kernel_supports_3_3__degridding_kernel_supports__0 = (int2*) malloc(num_kernels * sizeof(int2));
int2 *const g2g_1__gridding_kernel_supports__0 = (int2*) malloc(num_kernels * sizeof(int2));
int2 *const grid_measured_0__kernel_supports__0 = (int2*) malloc(num_kernels * sizeof(int2));
int2 *const g2g_1__gridding_kernel_supports__1 = (int2*) malloc(num_kernels * sizeof(int2));
int2 *const grid_measured_0__kernel_supports__1 = (int2*) malloc(num_kernels * sizeof(int2));
int2 *const g2g_1__gridding_kernel_supports__2 = (int2*) malloc(num_kernels * sizeof(int2));
int2 *const grid_measured_0__kernel_supports__2 = (int2*) malloc(num_kernels * sizeof(int2));
int2 *const g2g_1__gridding_kernel_supports__3 = (int2*) malloc(num_kernels * sizeof(int2));
int2 *const grid_measured_0__kernel_supports__3 = (int2*) malloc(num_kernels * sizeof(int2));
int *const num_vis__input__0 = (int*) malloc(4 * sizeof(int));
int *const maj_iter_out__maj_iter__0 = (int*) malloc(4 * sizeof(int));
Config *const output_configs__input__0 = (Config*) malloc(4 * sizeof(Config));
int *const num_vis_0__input__0 = (int*) malloc(1 * sizeof(int));
int *const num_vis_1__input__0 = (int*) malloc(1 * sizeof(int));
int *const num_vis_2__input__0 = (int*) malloc(1 * sizeof(int));
int *const num_vis_3__input__0 = (int*) malloc(1 * sizeof(int));
int *const maj_iter_out_0__maj_iter__0 = (int*) malloc(1 * sizeof(int));
int *const maj_iter_out_1__maj_iter__0 = (int*) malloc(1 * sizeof(int));
int *const maj_iter_out_2__maj_iter__0 = (int*) malloc(1 * sizeof(int));
int *const maj_iter_out_3__maj_iter__0 = (int*) malloc(1 * sizeof(int));
int *const grid_measurement_0__num_corrected_visibilities__0 = (int*) malloc(1 * sizeof(int));
int *const g2g_1__num_corrected_visibilities__0 = (int*) malloc(1 * sizeof(int));
int *const grid_measurement_0__num_corrected_visibilities__1 = (int*) malloc(1 * sizeof(int));
int *const g2g_1__num_corrected_visibilities__1 = (int*) malloc(1 * sizeof(int));
int *const grid_measurement_0__num_corrected_visibilities__2 = (int*) malloc(1 * sizeof(int));
int *const g2g_1__num_corrected_visibilities__2 = (int*) malloc(1 * sizeof(int));
int *const grid_measurement_0__num_corrected_visibilities__3 = (int*) malloc(1 * sizeof(int));
int *const g2g_1__num_corrected_visibilities__3 = (int*) malloc(1 * sizeof(int));
Config *const out__input__2 = (Config*) malloc(1 * sizeof(Config));
Config *const fft_run_0__input__0 = (Config*) malloc(1 * sizeof(Config));
Config *const inverse_fft_run_1__input__0 = (Config*) malloc(1 * sizeof(Config));
Config *const finegrid_2__input__0 = (Config*) malloc(1 * sizeof(Config));
Config *const conv_correction_3__config__0 = (Config*) malloc(1 * sizeof(Config));
Config *const inv_conv_correction_4__config__0 = (Config*) malloc(1 * sizeof(Config));
Config *const inv_fft_measurements_5__input__0 = (Config*) malloc(1 * sizeof(Config));
Config *const conv_correction_est_6__config__0 = (Config*) malloc(1 * sizeof(Config));
Config *const split_7__config__0 = (Config*) malloc(1 * sizeof(Config));
Config *const output1_0__config__0 = (Config*) malloc(1 * sizeof(Config));
Config *const output2_1__config__0 = (Config*) malloc(1 * sizeof(Config));
Config *const output1_0__config__1 = (Config*) malloc(1 * sizeof(Config));
Config *const output2_1__config__1 = (Config*) malloc(1 * sizeof(Config));
Config *const output1_0__config__2 = (Config*) malloc(1 * sizeof(Config));
Config *const output2_1__config__2 = (Config*) malloc(1 * sizeof(Config));
Config *const output3_2__config__0 = (Config*) malloc(1 * sizeof(Config));
Config *const output1_0__config__3 = (Config*) malloc(1 * sizeof(Config));
Config *const output2_1__config__3 = (Config*) malloc(1 * sizeof(Config));
Config *const output_configs_0__input__0 = (Config*) malloc(1 * sizeof(Config));
Config *const output_configs_1__input__0 = (Config*) malloc(1 * sizeof(Config));
Config *const output_configs_2__input__0 = (Config*) malloc(1 * sizeof(Config));
Config *const output_configs_3__input__0 = (Config*) malloc(1 * sizeof(Config));
Config *const grid_0__config__0 = (Config*) malloc(1 * sizeof(Config));
Config *const g2g_1__config__0 = (Config*) malloc(1 * sizeof(Config));
Config *const grid_0__config__1 = (Config*) malloc(1 * sizeof(Config));
Config *const g2g_1__config__1 = (Config*) malloc(1 * sizeof(Config));
Config *const grid_0__config__2 = (Config*) malloc(1 * sizeof(Config));
Config *const g2g_1__config__2 = (Config*) malloc(1 * sizeof(Config));
Config *const grid_0__config__3 = (Config*) malloc(1 * sizeof(Config));
Config *const g2g_1__config__3 = (Config*) malloc(1 * sizeof(Config));

  PRECISION2 *const output_visibilities__visibilities__0 = (PRECISION2*) malloc( num_vis * sizeof(PRECISION2)); // delta_0_split_s2s_0_output_visibilities > delta_0_explode_delta_0_split_s2s_0_output_visibilities_visibilities size:= num_vis*PRECISION2
  PRECISION2 *const output_visibilities_0__visibilities__0 = (PRECISION2*) malloc((size_t) ceil((double)num_vis / slice) * sizeof(PRECISION2)); // delta_0_explode_delta_0_split_s2s_0_output_visibilities_output_visibilities_0 > delta_0_grid_0_visibilities size:= (size_t) ceil((double)num_vis / slice)*PRECISION2
  PRECISION2 *const output_visibilities_1__visibilities__0 = (PRECISION2*) malloc((size_t) ceil((double)num_vis / slice) * sizeof(PRECISION2)); // delta_0_explode_delta_0_split_s2s_0_output_visibilities_output_visibilities_0 > delta_0_grid_0_visibilities size:= (size_t) ceil((double)num_vis / slice)*PRECISION2
  PRECISION2 *const output_visibilities_2__visibilities__0 = (PRECISION2*) malloc((size_t) ceil((double)num_vis / slice) * sizeof(PRECISION2)); // delta_0_explode_delta_0_split_s2s_0_output_visibilities_output_visibilities_0 > delta_0_grid_0_visibilities size:= (size_t) ceil((double)num_vis / slice)*PRECISION2
  PRECISION2 *const output_visibilities_3__visibilities__0 = (PRECISION2*) malloc((size_t) ceil((double)num_vis / slice) * sizeof(PRECISION2)); // delta_0_explode_delta_0_split_s2s_0_output_visibilities_output_visibilities_0 > delta_0_grid_0_visibilities size:= (size_t) ceil((double)num_vis / slice)*PRECISION2



#ifdef PREESM_MD5_UPDATE
	PREESM_MD5_CTX preesm_md5_ctx_out__source_list__0;
	PREESM_MD5_Init(&preesm_md5_ctx_out__source_list__0);
	PREESM_MD5_CTX preesm_md5_ctx_out__num_sources__0;
	PREESM_MD5_Init(&preesm_md5_ctx_out__num_sources__0);
	PREESM_MD5_CTX preesm_md5_ctx_out__psf__0;
	PREESM_MD5_Init(&preesm_md5_ctx_out__psf__0);
	PREESM_MD5_CTX preesm_md5_ctx_output_1__in__0;
	PREESM_MD5_Init(&preesm_md5_ctx_output_1__in__0);
	PREESM_MD5_CTX preesm_md5_ctx_result__in__0;
	PREESM_MD5_Init(&preesm_md5_ctx_result__in__0);
#endif
// Initialisation(s)

  fifoInit(FIFO_Head_delta_end_out_Broadcast_gridded_measured_prev__d__0, grid_size*grid_size, NULL, 0); // grid_size*grid_size * char

  // Begin the execution loop
  pthread_barrier_wait(&iter_barrier);
#ifdef PREESM_LOOP_SIZE // Case of a finite loop
	int index;
	for(index=0;index<PREESM_LOOP_SIZE && !preesmStopThreads;index++){
#else // Default case of an infinite loop
  while (!preesmStopThreads) {
#endif
    // loop body
    fifoPop(prev_grid__prev_grid__0, FIFO_Head_delta_end_out_Broadcast_gridded_measured_prev__d__0, grid_size*grid_size, NULL,
        0); // grid_size*grid_size * char


    // Broadcast BR_delta_0__degridding_kernel_supports

    {
      // memcpy #0
      memcpy(degridding_kernel_supports_0_3__degridding_kernel_supports__0 + 0, args->degridding_kernel_supports + 0,
          num_kernels); // num_kernels * int2
      // memcpy #0
      memcpy(degridding_kernel_supports_1_3__degridding_kernel_supports__0 + 0, args->degridding_kernel_supports + 0,
          num_kernels); // num_kernels * int2
      // memcpy #0
      memcpy(degridding_kernel_supports_2_3__degridding_kernel_supports__0 + 0, args->degridding_kernel_supports + 0,
          num_kernels); // num_kernels * int2
      // memcpy #0
      memcpy(degridding_kernel_supports_3_3__degridding_kernel_supports__0 + 0, args->degridding_kernel_supports + 0,
          num_kernels); // num_kernels * int2
    }

    // Broadcast BR_delta_0__degridding_kernels

    {
      // memcpy #0
      memcpy(degridding_kernels_0_3__degridding_kernels__0 + 0, args->degridding_kernels + 0, total_kernels_samples); // total_kernels_samples * PRECISION2
      // memcpy #0
      memcpy(degridding_kernels_1_3__degridding_kernels__0 + 0, args->degridding_kernels + 0, total_kernels_samples); // total_kernels_samples * PRECISION2
      // memcpy #0
      memcpy(degridding_kernels_2_3__degridding_kernels__0 + 0, args->degridding_kernels + 0, total_kernels_samples); // total_kernels_samples * PRECISION2
      // memcpy #0
      memcpy(degridding_kernels_3_3__degridding_kernels__0 + 0, args->degridding_kernels + 0, total_kernels_samples); // total_kernels_samples * PRECISION2
    }

    // Broadcast BR_delta_0__gridding_kernel_supports

    {
      // memcpy #0
      memcpy(gridding_kernel_supports_0_3__input__0 + 0, args->gridding_kernel_supports + 0, num_kernels); // num_kernels * int2
      // memcpy #0
      memcpy(gridding_kernel_supports_1_3__input__0 + 0, args->gridding_kernel_supports + 0, num_kernels); // num_kernels * int2
      // memcpy #0
      memcpy(gridding_kernel_supports_2_3__input__0 + 0, args->gridding_kernel_supports + 0, num_kernels); // num_kernels * int2
      // memcpy #0
      memcpy(gridding_kernel_supports_3_3__input__0 + 0, args->gridding_kernel_supports + 0, num_kernels); // num_kernels * int2
    }

    // Broadcast BR_delta_0__gridding_kernels

    {
      // memcpy #0
      memcpy(gridding_kernels_0_3__input__0 + 0, args->gridding_kernels + 0, total_kernels_samples); // total_kernels_samples * PRECISION2
      // memcpy #0
      memcpy(gridding_kernels_1_3__input__0 + 0, args->gridding_kernels + 0, total_kernels_samples); // total_kernels_samples * PRECISION2
      // memcpy #0
      memcpy(gridding_kernels_2_3__input__0 + 0, args->gridding_kernels + 0, total_kernels_samples); // total_kernels_samples * PRECISION2
      // memcpy #0
      memcpy(gridding_kernels_3_3__input__0 + 0, args->gridding_kernels + 0, total_kernels_samples); // total_kernels_samples * PRECISION2
    }

    // Broadcast delta_0_Broadcast_config_0

    {
      // memcpy #0
      memcpy(fft_run_0__input__0 + 0, &args->config + 0, 1); // 1 * Config
      // memcpy #0
      memcpy(inverse_fft_run_1__input__0 + 0, &out__input__2 + 0, 1); // 1 * Config
      // memcpy #0
      memcpy(finegrid_2__input__0 + 0, &args->config + 0, 1); // 1 * Config
      // memcpy #0
      memcpy(conv_correction_3__config__0 + 0, &args->config + 0, 1); // 1 * Config
      // memcpy #0
      memcpy(inv_conv_correction_4__config__0 + 0, &args->config + 0, 1); // 1 * Config
      // memcpy #0
      memcpy(inv_fft_measurements_5__input__0 + 0, &args->config + 0, 1); // 1 * Config
      // memcpy #0
      memcpy(conv_correction_est_6__config__0 + 0, &args->config + 0, 1); // 1 * Config
      // memcpy #0
      memcpy(split_7__config__0 + 0, &args->config + 0, 1); // 1 * Config
    }

    // Broadcast delta_0_Broadcast_prolate_0

    {
      // memcpy #0
      memcpy(inv_conv_correction_0__prolate__0 + 0, args->prolate + 0, (size_t) ceil((double)grid_size / 2)); // (size_t) ceil((double)grid_size / 2) * PRECISION
      // memcpy #0
      memcpy(conv_correction_1__prolate__0 + 0, args->prolate + 0, (size_t) ceil((double)grid_size / 2)); // (size_t) ceil((double)grid_size / 2) * PRECISION
      // memcpy #0
      memcpy(conv_correction_est_2__prolate__0 + 0, args->prolate + 0, (size_t) ceil((double)grid_size / 2)); // (size_t) ceil((double)grid_size / 2) * PRECISION
    }

    source_list_sink(num_minor_cycle/*MAX_SOURCES*/, args->source_list, args->num_source); // delta_0_source_list_sink_0
#ifdef PREESM_MD5_UPDATE
		PREESM_MD5_Update(&preesm_md5_ctx_out__source_list__0,(char *)out__source_list__0, num_minor_cycle);
		PREESM_MD5_Update(&preesm_md5_ctx_out__num_sources__0,(char *)out__num_sources__0, 4);
		#endif

    // Broadcast delta_0_Broadcast_gridding_kernel_supports_0

    {
      // memcpy #0
      memcpy(grid_measured_0__kernel_supports__0 + 0, gridding_kernel_supports_0_3__input__0 + 0, num_kernels); // num_kernels * int2
      // memcpy #0
      memcpy(g2g_1__gridding_kernel_supports__0 + 0, gridding_kernel_supports_0_3__input__0 + 0, num_kernels); // num_kernels * int2
    }

    // Broadcast delta_0_Broadcast_gridding_kernel_supports_1

    {
      // memcpy #0
      memcpy(grid_measured_0__kernel_supports__1 + 0, gridding_kernel_supports_1_3__input__0 + 0, num_kernels); // num_kernels * int2
      // memcpy #0
      memcpy(g2g_1__gridding_kernel_supports__1 + 0, gridding_kernel_supports_1_3__input__0 + 0, num_kernels); // num_kernels * int2
    }

    // Broadcast delta_0_Broadcast_gridding_kernel_supports_2

    {
      // memcpy #0
      memcpy(grid_measured_0__kernel_supports__2 + 0, gridding_kernel_supports_2_3__input__0 + 0, num_kernels); // num_kernels * int2
      // memcpy #0
      memcpy(g2g_1__gridding_kernel_supports__2 + 0, gridding_kernel_supports_2_3__input__0 + 0, num_kernels); // num_kernels * int2
    }

    // Broadcast delta_0_Broadcast_gridding_kernel_supports_3

    {
      // memcpy #0
      memcpy(grid_measured_0__kernel_supports__3 + 0, gridding_kernel_supports_3_3__input__0 + 0, num_kernels); // num_kernels * int2
      // memcpy #0
      memcpy(g2g_1__gridding_kernel_supports__3 + 0, gridding_kernel_supports_3_3__input__0 + 0, num_kernels); // num_kernels * int2
    }

    // Broadcast delta_0_correct_to_finegrid_0_Broadcast_config_0

    {
      // memcpy #0
      memcpy(output1_0__config__2 + 0, finegrid_2__input__0 + 0, 1); // 1 * Config
      // memcpy #0
      memcpy(output2_1__config__2 + 0, finegrid_2__input__0 + 0, 1); // 1 * Config
      // memcpy #0
      memcpy(output3_2__config__0 + 0, finegrid_2__input__0 + 0, 1); // 1 * Config
    }

    // Broadcast delta_0_fft_run_0_Broadcast_config_0

    {
      // memcpy #0
      memcpy(output1_0__config__0 + 0, fft_run_0__input__0 + 0, 1); // 1 * Config
      // memcpy #0
      memcpy(output2_1__config__0 + 0, fft_run_0__input__0 + 0, 1); // 1 * Config
    }

    // Broadcast delta_0_inverse_fft_run_estimation_0_Broadcast_config_0

    {
      // memcpy #0
      memcpy(output1_0__config__1 + 0, inverse_fft_run_1__input__0 + 0, 1); // 1 * Config
      // memcpy #0
      memcpy(output2_1__config__1 + 0, inverse_fft_run_1__input__0 + 0, 1); // 1 * Config
    }

    // Broadcast delta_0_inverse_fft_run_measurements_0_Broadcast_config_0

    {
      // memcpy #0
      memcpy(output1_0__config__3 + 0, inv_fft_measurements_5__input__0 + 0, 1); // 1 * Config
      // memcpy #0
      memcpy(output2_1__config__3 + 0, inv_fft_measurements_5__input__0 + 0, 1); // 1 * Config
    }

    reciprocal_transform_actor(num_receiver/*NUM_RECEIVERS*/, args->gains, output1_0__config__2, gains_out__gains__0); // delta_0_correct_to_finegrid_0_reciprocal_transform_actor_0

    // Broadcast delta_0_Broadcast_image_estimate_0

    {
      // memcpy #0
      memcpy(fft_run_0__dirty_image_in__0 + 0, args->image_estimate + 0, grid_size*grid_size); // grid_size*grid_size * PRECISION
      // memcpy #0
      memcpy(args->delta_image + 0, args->image_estimate + 0, grid_size*grid_size); // grid_size*grid_size * PRECISION
    }

    psf_sink(grid_size/*GRID_SIZE*/, args->psf); // delta_0_psf_sink_0
#ifdef PREESM_MD5_UPDATE
		PREESM_MD5_Update(&preesm_md5_ctx_out__psf__0,(char *)out__psf__0, grid_size*grid_size);
		#endif

    apply_gains_only(num_receiver/*NUM_RECEIVERS*/, num_baselines/*NUM_BASELINES*/, num_vis/*NUM_VISIBILITIES*/, args->measured_visibilities,
        gains_out__gains__0, args->receiver_pairs, output2_1__config__2, visibilities_out__input_visibilities__0); // delta_0_correct_to_finegrid_0_apply_gains_0

    correct_to_finegrid(num_vis/*NUM_VISIBILITIES*/, grid_size/*GRID_SIZE*/, 16/*OVERSAMPLING_FACTOR*/,
        0/*PERFORM_SIMPLIFICATION*/, args->vis_uvw_coords, visibilities_out__input_visibilities__0,
        output3_2__config__0, output_visibilities__measured_visibilities__0, output_finegrid_vis_coords__vis_coords__0,
        num_output_visibilities__num_corrected_vis__0); // delta_0_correct_to_finegrid_0_correct_to_finegrid_0

    split_fftdegrid_visibilities(num_vis/*NUM_VISIBILITIES*/, slice/*SLICES*/, grid_size/*GRID_SIZE*/, split_7__config__0,
        output_finegrid_vis_coords__vis_coords__0, output_visibilities__measured_visibilities__0,
        num_output_visibilities__num_corrected_vis__0, args->major_iter, output_visibilities__visibilities__0,
        out_vis_coords__input__0, output_configs__input__0, num_vis__input__0, maj_iter_out__maj_iter__0); // delta_0_split_s2s_0

    // Fork delta_0_explode_delta_0_split_s2s_0_maj_iter_out

    {
      memcpy(maj_iter_out_0__maj_iter__0 + 0, maj_iter_out__maj_iter__0 + 0, 4); // 1 * int
      memcpy(maj_iter_out_1__maj_iter__0 + 0, maj_iter_out__maj_iter__0 + 1, 4); // 1 * int
      memcpy(maj_iter_out_2__maj_iter__0 + 0, maj_iter_out__maj_iter__0 + 2, 4); // 1 * int
      memcpy(maj_iter_out_3__maj_iter__0 + 0, maj_iter_out__maj_iter__0 + 3, 4); // 1 * int
    }
    // Fork delta_0_explode_delta_0_split_s2s_0_num_vis

    {
      memcpy(num_vis_0__input__0 + 0, num_vis__input__0 + 0, 4); // 1 * int
      memcpy(num_vis_1__input__0 + 0, num_vis__input__0 + 1, 4); // 1 * int
      memcpy(num_vis_2__input__0 + 0, num_vis__input__0 + 2, 4); // 1 * int
      memcpy(num_vis_3__input__0 + 0, num_vis__input__0 + 3, 4); // 1 * int
    }
    // Fork delta_0_explode_delta_0_split_s2s_0_out_vis_coords

    {
      memcpy(out_vis_coords_0__input__0 + 0, out_vis_coords__input__0 + 0, (size_t) ceil((double)num_vis / slice)); // (size_t) ceil((double)num_vis / slice) * PRECISION3
      memcpy(out_vis_coords_1__input__0 + 0, out_vis_coords__input__0 + (size_t) ceil((double)num_vis / slice), (size_t) ceil((double)num_vis / slice)); // (size_t) ceil((double)num_vis / slice) * PRECISION3
      memcpy(out_vis_coords_2__input__0 + 0, out_vis_coords__input__0 + 2*(size_t) ceil((double)num_vis / slice), (size_t) ceil((double)num_vis / slice)); // (size_t) ceil((double)num_vis / slice) * PRECISION3
      memcpy(out_vis_coords_3__input__0 + 0, out_vis_coords__input__0 + 3*(size_t) ceil((double)num_vis / slice), (size_t) ceil((double)num_vis / slice)); // (size_t) ceil((double)num_vis / slice) * PRECISION3
    }
    // Fork delta_0_explode_delta_0_split_s2s_0_output_configs

    {
      memcpy(output_configs_0__input__0 + 0, output_configs__input__0 + 0, 1); // 1 * Config
      memcpy(output_configs_1__input__0 + 0, output_configs__input__0 + 1, 1); // 1 * Config
      memcpy(output_configs_2__input__0 + 0, output_configs__input__0 + 2, 1); // 1 * Config
      memcpy(output_configs_3__input__0 + 0, output_configs__input__0 + 3, 1); // 1 * Config
    }
    // Fork delta_0_explode_delta_0_split_s2s_0_output_visibilities

    {
      memcpy(output_visibilities_0__visibilities__0 + 0, output_visibilities__visibilities__0 + 0, (size_t) ceil((double)num_vis / slice)); // (size_t) ceil((double)num_vis / slice) * PRECISION2
      memcpy(output_visibilities_1__visibilities__0 + 0, output_visibilities__visibilities__0 + (size_t) ceil((double)num_vis / slice), (size_t) ceil((double)num_vis / slice)); // (size_t) ceil((double)num_vis / slice) * PRECISION2
      memcpy(output_visibilities_2__visibilities__0 + 0, output_visibilities__visibilities__0 + 2*(size_t) ceil((double)num_vis / slice), (size_t) ceil((double)num_vis / slice)); // (size_t) ceil((double)num_vis / slice) * PRECISION2
      memcpy(output_visibilities_3__visibilities__0 + 0, output_visibilities__visibilities__0 + 3*(size_t) ceil((double)num_vis / slice), (size_t) ceil((double)num_vis / slice)); // (size_t) ceil((double)num_vis / slice) * PRECISION2
    }
    // Broadcast delta_0_Broadcast_configs_0

    {
      // memcpy #0
      memcpy(grid_0__config__0 + 0, output_configs_0__input__0 + 0, 1); // 1 * Config
      // memcpy #0
      memcpy(g2g_1__config__0 + 0, output_configs_0__input__0 + 0, 1); // 1 * Config
    }

    // Broadcast delta_0_Broadcast_configs_1

    {
      // memcpy #0
      memcpy(grid_0__config__1 + 0, output_configs_1__input__0 + 0, 1); // 1 * Config
      // memcpy #0
      memcpy(g2g_1__config__1 + 0, output_configs_1__input__0 + 0, 1); // 1 * Config
    }

    // Broadcast delta_0_Broadcast_configs_2

    {
      // memcpy #0
      memcpy(grid_0__config__2 + 0, output_configs_2__input__0 + 0, 1); // 1 * Config
      // memcpy #0
      memcpy(g2g_1__config__2 + 0, output_configs_2__input__0 + 0, 1); // 1 * Config
    }

    // Broadcast delta_0_Broadcast_configs_3

    {
      // memcpy #0
      memcpy(grid_0__config__3 + 0, output_configs_3__input__0 + 0, 1); // 1 * Config
      // memcpy #0
      memcpy(g2g_1__config__3 + 0, output_configs_3__input__0 + 0, 1); // 1 * Config
    }

    // Broadcast delta_0_Broadcast_num_visibilities_0

    {
      // memcpy #0
      memcpy(grid_measurement_0__num_corrected_visibilities__0 + 0, num_vis_0__input__0 + 0, 4); // 1 * int
      // memcpy #0
      memcpy(g2g_1__num_corrected_visibilities__0 + 0, num_vis_0__input__0 + 0, 4); // 1 * int
    }

    // Broadcast delta_0_Broadcast_num_visibilities_1

    {
      // memcpy #0
      memcpy(grid_measurement_0__num_corrected_visibilities__1 + 0, num_vis_1__input__0 + 0, 4); // 1 * int
      // memcpy #0
      memcpy(g2g_1__num_corrected_visibilities__1 + 0, num_vis_1__input__0 + 0, 4); // 1 * int
    }

    // Broadcast delta_0_Broadcast_num_visibilities_2

    {
      // memcpy #0
      memcpy(grid_measurement_0__num_corrected_visibilities__2 + 0, num_vis_2__input__0 + 0, 4); // 1 * int
      // memcpy #0
      memcpy(g2g_1__num_corrected_visibilities__2 + 0, num_vis_2__input__0 + 0, 4); // 1 * int
    }

    // Broadcast delta_0_Broadcast_num_visibilities_3

    {
      // memcpy #0
      memcpy(grid_measurement_0__num_corrected_visibilities__3 + 0, num_vis_3__input__0 + 0, 4); // 1 * int
      // memcpy #0
      memcpy(g2g_1__num_corrected_visibilities__3 + 0, num_vis_3__input__0 + 0, 4); // 1 * int
    }

    // Broadcast delta_0_Broadcast_gridding_kernels_0

    {
      // memcpy #0
      memcpy(grid_measured_0__kernels__0 + 0, gridding_kernels_0_3__input__0 + 0, total_kernels_samples); // total_kernels_samples * PRECISION2
      // memcpy #0
      memcpy(g2g_1__gridding_kernels__0 + 0, gridding_kernels_0_3__input__0 + 0, total_kernels_samples); // total_kernels_samples * PRECISION2
    }

    // Broadcast delta_0_Broadcast_gridding_kernels_1

    {
      // memcpy #0
      memcpy(grid_measured_0__kernels__1 + 0, gridding_kernels_1_3__input__0 + 0, total_kernels_samples); // total_kernels_samples * PRECISION2
      // memcpy #0
      memcpy(g2g_1__gridding_kernels__1 + 0, gridding_kernels_1_3__input__0 + 0, total_kernels_samples); // total_kernels_samples * PRECISION2
    }

    // Broadcast delta_0_Broadcast_gridding_kernels_2

    {
      // memcpy #0
      memcpy(grid_measured_0__kernels__2 + 0, gridding_kernels_2_3__input__0 + 0, total_kernels_samples); // total_kernels_samples * PRECISION2
      // memcpy #0
      memcpy(g2g_1__gridding_kernels__2 + 0, gridding_kernels_2_3__input__0 + 0, total_kernels_samples); // total_kernels_samples * PRECISION2
    }

    // Broadcast delta_0_Broadcast_gridding_kernels_3

    {
      // memcpy #0
      memcpy(grid_measured_0__kernels__3 + 0, gridding_kernels_3_3__input__0 + 0, total_kernels_samples); // total_kernels_samples * PRECISION2
      // memcpy #0
      memcpy(g2g_1__gridding_kernels__3 + 0, gridding_kernels_3_3__input__0 + 0, total_kernels_samples); // total_kernels_samples * PRECISION2
    }

    // Broadcast delta_0_Broadcast_corrected_viscoords_0

    {
      // memcpy #0
      memcpy(g2g_0__corrected_vis_uvw_coords__0 + 0, out_vis_coords_0__input__0 + 0, (size_t) ceil((double)num_vis / slice)); // (size_t) ceil((double)num_vis / slice) * PRECISION3
      // memcpy #0
      memcpy(grid_measured_1__corrected_vis_uvw_coords__0 + 0, out_vis_coords_0__input__0 + 0, (size_t) ceil((double)num_vis / slice)); // (size_t) ceil((double)num_vis / slice) * PRECISION3
    }

    // Broadcast delta_0_Broadcast_corrected_viscoords_1

    {
      // memcpy #0
      memcpy(g2g_0__corrected_vis_uvw_coords__1 + 0, out_vis_coords_1__input__0 + 0, (size_t) ceil((double)num_vis / slice)); // (size_t) ceil((double)num_vis / slice) * PRECISION3
      // memcpy #0
      memcpy(grid_measured_1__corrected_vis_uvw_coords__1 + 0, out_vis_coords_1__input__0 + 0, (size_t) ceil((double)num_vis / slice)); // (size_t) ceil((double)num_vis / slice) * PRECISION3
    }

    // Broadcast delta_0_Broadcast_corrected_viscoords_2

    {
      // memcpy #0
      memcpy(g2g_0__corrected_vis_uvw_coords__2 + 0, out_vis_coords_2__input__0 + 0, (size_t) ceil((double)num_vis / slice)); // (size_t) ceil((double)num_vis / slice) * PRECISION3
      // memcpy #0
      memcpy(grid_measured_1__corrected_vis_uvw_coords__2 + 0, out_vis_coords_2__input__0 + 0, (size_t) ceil((double)num_vis / slice)); // (size_t) ceil((double)num_vis / slice) * PRECISION3
    }

    // Broadcast delta_0_Broadcast_corrected_viscoords_3

    {
      // memcpy #0
      memcpy(g2g_0__corrected_vis_uvw_coords__3 + 0, out_vis_coords_3__input__0 + 0, (size_t) ceil((double)num_vis / slice)); // (size_t) ceil((double)num_vis / slice) * PRECISION3
      // memcpy #0
      memcpy(grid_measured_1__corrected_vis_uvw_coords__3 + 0, out_vis_coords_3__input__0 + 0, (size_t) ceil((double)num_vis / slice)); // (size_t) ceil((double)num_vis / slice) * PRECISION3
    }

    std_gridding(grid_size/*GRID_SIZE*/, (size_t) ceil((double)num_vis / slice)/*NUM_VISIBILITIES*/, num_kernels/*NUM_KERNELS*/, total_kernels_samples/*TOTAL_KERNEL_SAMPLES*/,
        16/*OVERSAMPLING_FACTOR*/, 0/*BYPASS*/, maj_iter_out_0__maj_iter__0,
        grid_measurement_0__num_corrected_visibilities__0, grid_measured_0__kernels__0,
        grid_measured_0__kernel_supports__0, grid_measured_1__corrected_vis_uvw_coords__0,
        output_visibilities_0__visibilities__0, grid_0__config__0, prev_grid__prev_grid__0, output_grid__input__0); // delta_0_grid_0

    // Broadcast delta_0_Broadcast_gridded_measured_0

    {
      // memcpy #0
      memcpy(merge_0__grids_0__0 + 0, output_grid__input__0 + 0, grid_size*grid_size); // grid_size*grid_size * PRECISION2
      // memcpy #0
      memcpy(prev_1__prev_grid__0 + 0, output_grid__input__0 + 0, grid_size*grid_size); // grid_size*grid_size * PRECISION2
    }

    execute_inv_convolution_correction_actor(grid_size/*GRID_SIZE*/, fft_run_0__dirty_image_in__0,
        inv_conv_correction_0__prolate__0, inv_conv_correction_4__config__0, dirty_image_out__image__0); // delta_0_inv_conv_correction_0



    fft_shift_real_to_complex_actor(grid_size/*GRID_SIZE*/, dirty_image_out__image__0, output1_0__config__0,
        fourier__uv_grid_in__0); // delta_0_fft_run_0_fft_shift_real_to_complex_actor_0

    CUFFT_EXECUTE_FORWARD_C2C_actor(grid_size/*GRID_SIZE*/, fourier__uv_grid_in__0, uv_grid_out__uv_grid_in__0); // delta_0_fft_run_0_CUFFT_EXECUTE_FORWARD_C2C_actor_0

    fft_shift_complex_to_complex_actor(grid_size/*GRID_SIZE*/, uv_grid_out__uv_grid_in__0, output2_1__config__0,
        uv_grid_out__input_grid__0); // delta_0_fft_run_0_fft_shift_complex_to_complex_actor_0

    split_uvgrid(grid_size/*GRID_SIZE*/, 4/*SLICES*/, uv_grid_out__input_grid__0, output_grid__input_grid__0); // delta_0_split_uvgrid_0

    // Fork delta_0_explode_delta_0_split_uvgrid_0_output_grid

    {
      memcpy(output_grid_0__input_grid__0 + 0, output_grid__input_grid__0 + 0, grid_size*grid_size); // grid_size*grid_size * PRECISION2
      memcpy(output_grid_1__input_grid__0 + 0, output_grid__input_grid__0 + grid_size*grid_size, grid_size*grid_size); // grid_size*grid_size * PRECISION2
      memcpy(output_grid_2__input_grid__0 + 0, output_grid__input_grid__0 + 2*grid_size*grid_size, grid_size*grid_size); // grid_size*grid_size * PRECISION2
      memcpy(output_grid_3__input_grid__0 + 0, output_grid__input_grid__0 + 3*grid_size*grid_size, grid_size*grid_size); // grid_size*grid_size * PRECISION2
    }
    std_gridding(grid_size/*GRID_SIZE*/, (size_t) ceil((double)num_vis / slice)/*NUM_VISIBILITIES*/, num_kernels/*NUM_KERNELS*/, total_kernels_samples/*TOTAL_KERNEL_SAMPLES*/,
        16/*OVERSAMPLING_FACTOR*/, 0/*BYPASS*/, maj_iter_out_1__maj_iter__0,
        grid_measurement_0__num_corrected_visibilities__1, grid_measured_0__kernels__1,
        grid_measured_0__kernel_supports__1, grid_measured_1__corrected_vis_uvw_coords__1,
        output_visibilities_1__visibilities__0, grid_0__config__1, prev_1__prev_grid__0, output_grid__input__1); // delta_0_grid_1

    // Broadcast delta_0_Broadcast_gridded_measured_1

    {
      // memcpy #0
      memcpy(merge_0__grids_1__0 + 0, output_grid__input__1 + 0, grid_size*grid_size); // grid_size*grid_size * PRECISION2
      // memcpy #0
      memcpy(prev_1__prev_grid__1 + 0, output_grid__input__1 + 0, grid_size*grid_size); // grid_size*grid_size * PRECISION2
    }

    std_gridding(grid_size/*GRID_SIZE*/, (size_t) ceil((double)num_vis / slice)/*NUM_VISIBILITIES*/, num_kernels/*NUM_KERNELS*/, total_kernels_samples/*TOTAL_KERNEL_SAMPLES*/,
        16/*OVERSAMPLING_FACTOR*/, 0/*BYPASS*/, maj_iter_out_2__maj_iter__0,
        grid_measurement_0__num_corrected_visibilities__2, grid_measured_0__kernels__2,
        grid_measured_0__kernel_supports__2, grid_measured_1__corrected_vis_uvw_coords__2,
        output_visibilities_2__visibilities__0, grid_0__config__2, prev_1__prev_grid__1, output_grid__input__2); // delta_0_grid_2

    // Broadcast delta_0_Broadcast_gridded_measured_2

    {
      // memcpy #0
      memcpy(merge_0__grids_2__0 + 0, output_grid__input__2 + 0, grid_size*grid_size); // grid_size*grid_size * PRECISION2
      // memcpy #0
      memcpy(prev_1__prev_grid__2 + 0, output_grid__input__2 + 0, grid_size*grid_size); // grid_size*grid_size * PRECISION2
    }

    g2g_degridgrid(grid_size/*GRID_SIZE*/, (size_t) ceil((double)num_vis / slice)/*NUM_VISIBILITIES*/, num_kernels/*NUM_GRIDDING_KERNELS*/,
        num_kernels/*NUM_DEGRIDDING_KERNELS*/, total_kernels_samples/*TOTAL_GRIDDING_KERNEL_SAMPLES*/,
        total_kernels_samples/*TOTAL_DEGRIDDING_KERNEL_SAMPLES*/, 16/*OVERSAMPLING_FACTOR*/, g2g_1__gridding_kernels__0,
        g2g_1__gridding_kernel_supports__0, degridding_kernels_0_3__degridding_kernels__0,
        degridding_kernel_supports_0_3__degridding_kernel_supports__0, output_grid_0__input_grid__0,
        g2g_0__corrected_vis_uvw_coords__0, g2g_1__num_corrected_visibilities__0, g2g_1__config__0,
        output_grid__grids_0__0); // delta_0_g2g_degridgrid_0

    g2g_degridgrid(grid_size/*GRID_SIZE*/, (size_t) ceil((double)num_vis / slice)/*NUM_VISIBILITIES*/, num_kernels/*NUM_GRIDDING_KERNELS*/,
        num_kernels/*NUM_DEGRIDDING_KERNELS*/, total_kernels_samples/*TOTAL_GRIDDING_KERNEL_SAMPLES*/,
        total_kernels_samples/*TOTAL_DEGRIDDING_KERNEL_SAMPLES*/, 16/*OVERSAMPLING_FACTOR*/, g2g_1__gridding_kernels__1,
        g2g_1__gridding_kernel_supports__1, degridding_kernels_1_3__degridding_kernels__0,
        degridding_kernel_supports_1_3__degridding_kernel_supports__0, output_grid_1__input_grid__0,
        g2g_0__corrected_vis_uvw_coords__1, g2g_1__num_corrected_visibilities__1, g2g_1__config__1,
        output_grid__grids_1__0); // delta_0_g2g_degridgrid_1

    g2g_degridgrid(grid_size/*GRID_SIZE*/, (size_t) ceil((double)num_vis / slice)/*NUM_VISIBILITIES*/, num_kernels/*NUM_GRIDDING_KERNELS*/,
        num_kernels/*NUM_DEGRIDDING_KERNELS*/, total_kernels_samples/*TOTAL_GRIDDING_KERNEL_SAMPLES*/,
        total_kernels_samples/*TOTAL_DEGRIDDING_KERNEL_SAMPLES*/, 16/*OVERSAMPLING_FACTOR*/, g2g_1__gridding_kernels__2,
        g2g_1__gridding_kernel_supports__2, degridding_kernels_2_3__degridding_kernels__0,
        degridding_kernel_supports_2_3__degridding_kernel_supports__0, output_grid_2__input_grid__0,
        g2g_0__corrected_vis_uvw_coords__2, g2g_1__num_corrected_visibilities__2, g2g_1__config__2,
        output_grid__grids_2__0); // delta_0_g2g_degridgrid_2

    g2g_degridgrid(grid_size/*GRID_SIZE*/, (size_t) ceil((double)num_vis / slice)/*NUM_VISIBILITIES*/, num_kernels/*NUM_GRIDDING_KERNELS*/,
        num_kernels/*NUM_DEGRIDDING_KERNELS*/, total_kernels_samples/*TOTAL_GRIDDING_KERNEL_SAMPLES*/,
        total_kernels_samples/*TOTAL_DEGRIDDING_KERNEL_SAMPLES*/, 16/*OVERSAMPLING_FACTOR*/, g2g_1__gridding_kernels__3,
        g2g_1__gridding_kernel_supports__3, degridding_kernels_3_3__degridding_kernels__0,
        degridding_kernel_supports_3_3__degridding_kernel_supports__0, output_grid_3__input_grid__0,
        g2g_0__corrected_vis_uvw_coords__3, g2g_1__num_corrected_visibilities__3, g2g_1__config__3,
        output_grid__grids_3__0); // delta_0_g2g_degridgrid_3

    // Join delta_0_implode_delta_0_merge_estimate_grid_0_grids

    {
      memcpy(output_grid__grids__0 + 0, output_grid__grids_0__0 + 0, grid_size*grid_size); // grid_size*grid_size * PRECISION2
      memcpy(output_grid__grids__0 + grid_size*grid_size, output_grid__grids_1__0 + 0, grid_size*grid_size); // grid_size*grid_size * PRECISION2
      memcpy(output_grid__grids__0 + 2*grid_size*grid_size, output_grid__grids_2__0 + 0, grid_size*grid_size); // grid_size*grid_size * PRECISION2
      memcpy(output_grid__grids__0 + 3*grid_size*grid_size, output_grid__grids_3__0 + 0, grid_size*grid_size); // grid_size*grid_size * PRECISION2
    }
    std_gridding(grid_size/*GRID_SIZE*/, (size_t) ceil((double)num_vis / slice)/*NUM_VISIBILITIES*/, num_kernels/*NUM_KERNELS*/, total_kernels_samples/*TOTAL_KERNEL_SAMPLES*/,
        16/*OVERSAMPLING_FACTOR*/, 0/*BYPASS*/, maj_iter_out_3__maj_iter__0,
        grid_measurement_0__num_corrected_visibilities__3, grid_measured_0__kernels__3,
        grid_measured_0__kernel_supports__3, grid_measured_1__corrected_vis_uvw_coords__3,
        output_visibilities_3__visibilities__0, grid_0__config__3, prev_1__prev_grid__2, output_grid__input__3); // delta_0_grid_3

    // Broadcast delta_0_Broadcast_gridded_measured_3

    {
      // memcpy #0
      memcpy(merge_0__grids_3__0 + 0, output_grid__input__3 + 0, grid_size*grid_size); // grid_size*grid_size * PRECISION2
      // memcpy #0
      memcpy(prev_1_1__prev_1__0 + 0, output_grid__input__3 + 0, grid_size*grid_size); // grid_size*grid_size * PRECISION2
    }

    // Join delta_0_implode_delta_0_merge_measurement_grid_0_grids

    {
      memcpy(merge__grids__0 + 0, merge_0__grids_0__0 + 0, grid_size*grid_size); // grid_size*grid_size * PRECISION2
      memcpy(merge__grids__0 + grid_size*grid_size, merge_0__grids_1__0 + 0, grid_size*grid_size); // grid_size*grid_size * PRECISION2
      memcpy(merge__grids__0 + 2*grid_size*grid_size, merge_0__grids_2__0 + 0, grid_size*grid_size); // grid_size*grid_size * PRECISION2
      memcpy(merge__grids__0 + 3*grid_size*grid_size, merge_0__grids_3__0 + 0, grid_size*grid_size); // grid_size*grid_size * PRECISION2
    }
    fifoPush(prev_1_1__prev_1__0, FIFO_Head_delta_end_out_Broadcast_gridded_measured_prev__d__0, grid_size*grid_size, NULL, 0); // grid_size*grid_size * char
    merge_gridded_visibilities(grid_size/*GRID_SIZE*/, 4/*SLICES*/, output_grid__grids__0, output_grid__uv_grid_in__0); // delta_0_merge_estimate_grid_0

    fft_shift_complex_to_complex_actor(grid_size/*GRID_SIZE*/, output_grid__uv_grid_in__0, output1_0__config__1,
        uv_grid_out__uv_grid_in__1); // delta_0_inverse_fft_run_estimation_0_fft_shift_complex_to_complex_actor_0

    CUFFT_EXECUTE_INVERSE_C2C_actor(grid_size/*GRID_SIZE*/, uv_grid_out__uv_grid_in__1, uv_grid_out__uv_grid__0); // delta_0_inverse_fft_run_estimation_0_CUFFT_EXECUTE_INVERSE_C2C_actor_0

    fft_shift_complex_to_real_actor(grid_size/*GRID_SIZE*/, uv_grid_out__uv_grid__0, output2_1__config__1,
        dirty_image__dirty_image_in__0); // delta_0_inverse_fft_run_estimation_0_fft_shift_complex_to_real_actor_0

    execute_convolution_correction_actor(grid_size/*GRID_SIZE*/, dirty_image__dirty_image_in__0,
        conv_correction_est_2__prolate__0, conv_correction_est_6__config__0, dirty_image_out__estimate__0); // delta_0_convolution_correction_run_estimation_0_execute_convolution_correction_actor_0

    merge_gridded_visibilities(grid_size/*GRID_SIZE*/, 4/*SLICES*/, merge__grids__0, output_grid__uv_grid_in__1); // delta_0_merge_measurement_grid_0

    fft_shift_complex_to_complex_actor(grid_size/*GRID_SIZE*/, output_grid__uv_grid_in__1, output1_0__config__3,
        uv_grid_out__uv_grid_in__2); // delta_0_inverse_fft_run_measurements_0_fft_shift_complex_to_complex_actor_0

    CUFFT_EXECUTE_INVERSE_C2C_actor(grid_size/*GRID_SIZE*/, uv_grid_out__uv_grid_in__2, uv_grid_out__uv_grid__1); // delta_0_inverse_fft_run_measurements_0_CUFFT_EXECUTE_INVERSE_C2C_actor_0

    fft_shift_complex_to_real_actor(grid_size/*GRID_SIZE*/, uv_grid_out__uv_grid__1, output2_1__config__3,
        dirty_image__dirty_image_in__1); // delta_0_inverse_fft_run_measurements_0_fft_shift_complex_to_real_actor_0

    execute_convolution_correction_actor(grid_size/*GRID_SIZE*/, dirty_image__dirty_image_in__1,
        conv_correction_1__prolate__0, conv_correction_3__config__0, dirty_image_out__measurements__0); // delta_0_convolution_correction_run_0_execute_convolution_correction_actor_0

    subtract_image_space(grid_size/*GRID_SIZE*/, dirty_image_out__measurements__0, dirty_image_out__estimate__0,
        args->image_out); // delta_0_subtract_image_space_0



    // loop footer
    pthread_barrier_wait(&iter_barrier);

  }

#ifdef PREESM_MD5_UPDATE
	// Print MD5
	rk_sema_wait(&preesmPrintSema);
	unsigned char preesm_md5_chars_final[20] = { 0 };
	PREESM_MD5_Final(preesm_md5_chars_final, &preesm_md5_ctx_out__source_list__0);
	printf("preesm_md5_out__source_list__0 : ");
	for (int i = 16; i > 0; i -= 1){
		printf("%02x", *(preesm_md5_chars_final + i - 1));
	}
	printf("\n");
	fflush(stdout);
	PREESM_MD5_Final(preesm_md5_chars_final, &preesm_md5_ctx_out__num_sources__0);
	printf("preesm_md5_out__num_sources__0 : ");
	for (int i = 16; i > 0; i -= 1){
		printf("%02x", *(preesm_md5_chars_final + i - 1));
	}
	printf("\n");
	fflush(stdout);
	PREESM_MD5_Final(preesm_md5_chars_final, &preesm_md5_ctx_out__psf__0);
	printf("preesm_md5_out__psf__0 : ");
	for (int i = 16; i > 0; i -= 1){
		printf("%02x", *(preesm_md5_chars_final + i - 1));
	}
	printf("\n");
	fflush(stdout);
	PREESM_MD5_Final(preesm_md5_chars_final, &preesm_md5_ctx_output_1__in__0);
	printf("preesm_md5_output_1__in__0 : ");
	for (int i = 16; i > 0; i -= 1){
		printf("%02x", *(preesm_md5_chars_final + i - 1));
	}
	printf("\n");
	fflush(stdout);
	PREESM_MD5_Final(preesm_md5_chars_final, &preesm_md5_ctx_result__in__0);
	printf("preesm_md5_result__in__0 : ");
	for (int i = 16; i > 0; i -= 1){
		printf("%02x", *(preesm_md5_chars_final + i - 1));
	}
	printf("\n");
	fflush(stdout);
	rk_sema_post(&preesmPrintSema);
#endif



  return NULL;
}

